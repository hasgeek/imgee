{% extends "baseframe.html" %}
{% from "baseframe/components.html" import networkbar with context %}
{% from "baseframe/forms.html" import renderfield, renderform %}

{% block logo -%}
  <div id="logo"><a href="{{ g.user.profile_url }}">{{ config['SITE_TITLE'] }}</a></div>
{%- endblock %}

{% block basecontent %}
  {% block content %}
    <div class="row">
      <div class="span9 push-right">
        {% block maincontent %}
        {% endblock %}
      </div>
      <div class="span3 push-left">
        {% block sidebar %}
        
          <div class="sidebar well">
            <h4><a href="{{ url_for('profile_view',profile=profile.name) }}">{{ profile.title }}</a></h4>
            <em>{{ profile.stored_files.count() | safe }} images</em>
            <br /><br />
            <!-- Upload image -->
            <a href="#uploadModal" role="button" title="Upload image" class="btn" data-toggle="modal"><i class="icon-cloud-upload"></i>&nbsp;&nbsp;Upload image</a>
            <div id="uploadModal" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="uploadModalLabel" aria-hidden="true">
              <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                <h3>Upload image</h3>
              </div>
              <div class="modal-body">
                  <div class="form-box well">
                    <form action="{{ url_for('upload_file', profile=profile.name) }}" method="POST">
                      {{ renderform(uf_form) }}
                    </form>
                  </div>                 
              </div>
            </div>
            <!-- //Upload image -->
            <hr />

            <ul class="nav nav-list expandable1">
              <li class="nav-header">Labels</li> 
              <!-- List labels -->
              {% if profile.labels %}
                {% for label in profile.labels |sort(attribute='name')%}
                  <li><a href="{{url_for('show_label', profile=profile.name, label=label.name)}}"><i class="icon-tag"></i>{{label.name}}</a></li>
                {% endfor %}
              {% else %}
                <li>No Labels yet.</li>
              {% endif %}
              <!-- //List labels -->
            </ul><!-- /nav nav-list -->
            <a href="" class="more1">More</a>
            <ul class="nav nav-list">
              <!-- Unlabelled archive -->
              <li><a href="{{url_for('unlabelled_images', profile=profile.name)}}"><i class="icon-tag alt"></i>
              {% if profile.labels %}
                Unlabeled
              {% else %}
                Archive
              {% endif %}
              </a></li>
              <!-- //Unlabelled archive-->
            </ul>   
            <!-- Create new label -->
            <a href="#labelModal" role="button" title="Upload image" class="" data-toggle="modal"><i class="icon-plus"></i>&nbsp;Newlabel</a>
            {% if profile %}
              <div id="labelModal" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="labelModalLabel" aria-hidden="true">
                  <div class="modal-header">
                      <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                      <h3>Create Label</h3>
                  </div>
                  <div class="modal-body">
                      <div class="create-box well">
                          <div class="form-title"><i class="icon-tag"></i>&nbsp;&nbsp;Create label</div><hr />        
                          <form action="{{ url_for('create_label', profile=profile.name) }}" method="POST">
                            {{ renderform(cl_form) }}
                          </form> 
                      </div>                        
                  </div>
              </div>
            {%- endif %}
              <!-- //Create new label --> 
            <hr>
            <ul class="nav nav-list expandable2">
              <li class="nav-header">Profile And Organizations</li> 
              <li><a title="View your uploads" href="{{ g.user.profile_url }}"><i class="icon-user"></i>{{ g.user.fullname }}</a></li>
              {%- for org in g.user.organizations_owned() %}
                <li><a href="{{ url_for('profile_view', profile=org['name']) }}"><i class="icon-group"></i>{{ org.title }}</a></li>
              {%- endfor %}
            </ul>
            <a href="" class="more2">More</a>

          </div><!-- /sidebar well-->
          {% block extendedsidebar %}
          {% endblock %}
        {% endblock %} 
      </div><!-- /span3 -->   
    </div><!-- /row -->
  {% endblock %}
{% endblock %}

{% block footerscripts %}
<script type="text/javascript">
  $(".more1").click(function(){
    alert("Handler for .click() called.");
    var val = $(this).text();
    if (val == "More") {
      $(".expandable1").css('height', '100%');
      $(this).text("Less");
    } else {
      $(".expandable1").css('height', '80');
      $(this).text("More");
    }
    return false;
  });
   $(".more2").click(function(){
    alert("Handler for .click() called.");
    var val = $(this).text();
    if (val == "More") {
      $(".expandable2").css('height', '100%');
      $(this).text("Less");
    } else {
      $(".expandable2").css('height', '80');
      $(this).text("More");
    }
    return false;
  });
</script>

{% endblock %}

