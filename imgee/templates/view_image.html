{% extends "layout.html" %}
{% from 'baseframe/forms.html' import renderform %}

{% block footerscripts %}
<script type="text/javascript" src="{{url_for('static', filename='js/jquery.jeditable.min.js')}}"></script>
<script> var profile = '{{g.user.username}}';</script>
<script type="text/javascript" src="{{url_for('static', filename='js/edit_in_place.js')}}"></script>
<script>
    $('input#img_width').width(30);
    $('input#img_height').width(30);
    $('input#img_link').width(420);
    var file_url = "{{url_for('get_image', img_name=img.name)}}";
    $('input[id^="img_"]').change(function (){
        var url_with_size = file_url + '?size=' + $('input#img_width').val() + 'x' + ($('input#img_height').val() || '0');
        $('a#img_link').attr('href', url_with_size);
    });
</script>
{% endblock %}

{% block sidebar %}
{% set img_url= url_for('get_image', img_name=img.name) %}
<div class="span8">

    <div class="image-display">
        <img src="{{url_for('get_image', img_name=img.name)}}" />
    </div>
    <div class="heading editable_title" id="{{img.name}}">{{img.title}}</div>

    {% if img.labels %}
        Labels:
        {% for label in img.labels %}
            <span class="label">
                <a href="{{url_for('show_label', profile_name=img.profile.name, label_name=label.name)}}"><i class="icon-tag"></i>&nbsp;{{label.name}}</a>
            </span>
        {% endfor %}
    {% endif %}
    <br/>
    Link to <a href='{{img_url}}'>original image</a> | At a different size:
    <input id='img_width' placeholder="w" />X<input id='img_height' placeholder="h" />
    <a href='{{img_url}}' id='img_link'> here</a>.
    <br/>
</div>
{% endblock %}

{% block albumcontent %}
{% set action_url=url_for('manage_labels', img_name=img.name, profile_name=img.profile.name) %}
    <div class="span4">
        <a class="btn btn-danger" href="{{url_for('delete_file', profile=g.user.username, img_name=img.name)}}"><i class="icon-trash"></i>&nbsp;Delete Image</a>
        <div class="padding"></div>
        <div class="form-box well">
            
            <div class="form-title"><i class="icon-tag"></i>&nbsp;&nbsp;Manage labels</div><hr />
            <div>{{ renderform(form, 'Manage Labels', action=action_url)}}</div>
        </div>
    </div>

{% endblock %}
