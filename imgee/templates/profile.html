{% extends "layout.html" %}
{% from 'baseframe/forms.html' import renderform %}

{% block title %}{{ profile.title }}{% endblock %}

{% block footerscripts %}
<script type="text/javascript" src="{{url_for('static', filename='js/jquery.jeditable.min.js')}}"></script>
<script> var profile = '{{g.user.profile_name}}'; </script>
<script type="text/javascript" src="{{url_for('static', filename='js/edit_in_place.js')}}"></script>
<script type="text/javascript" src="{{ url_for('static', filename='js/list-grid.js') }}"></script>
{% endblock %}

{% block maincontent %}
  <section class="profile">
    {{ title_form.hidden_tag() }}
    {% if files %}
      <div class="row">
        <div class="list-grid-selector span9">
          <div class="btn-group">
            <a href="#" id="gridview" class="btn switcher active"><i class="icon-th-large"></i></a>
            <a href="#" id="listview" class="btn switcher"><i class="icon-list"></i></a>
          </div>
        </div>
      </div>
    {% endif %}
        
    {% if unlabelled %}
      {% if profile.labels %}
        <div class="heading note">Unlabeled-image Archive</div>
      {% else %}
        <div class="heading note">Archived Images</div>
      {% endif %}
      <br />
    {% endif %}

    <div class="row">
      <div class="spann9">
        {% if files %}
          <div class="gallery">
            <ul id="showcase" class="grid">
              <div id="row-ctrl">
                <section class="top">
                  <div class="span1">Image</div>
                  <div class="span3">Title</div>
                  <div class="span2">Uploaded at</div>
                  <div class="span3">Labels</div>
                </section>

                {% for img in files %}
                  <li class="image">
                    <a href="{{url_for('view_image', profile=g.user.profile_name, image=img.name)}}" title="view image">
                      <section class="left">
                        <div class="image-thumb">    
                          <img src="{{url_for('get_thumbnail', image=img.name)}}"/>
                        </div>
                      </section>
                    </a>
                    
                    <section class="right span8">
                      <div class="row">   
                        <a href="{{url_for('view_image', profile=g.user.profile_name, image=img.name)}}" title="view image">                                 
                          <div class="title editable_title span3" id="{{img.name}}">{{img.title}}</div>
                          <div class="span2 date">{{ img.created_at }}</div>
                        </a>
                        <div class="labels span2">
                          {% for label in img.labels %}
                            <span class="label">
                              <a href="{{url_for('show_label', profile=img.profile.name, label=label.name)}}">{{label.name}}</a>
                            </span>
                          {% endfor %}
                        </div>
                      </div>
                    </section> 
                  </li><!-- /image -->
                {% endfor %}  
              </div><!-- /row-ctrl -->
            </ul><!-- showcase -->
          </div><!-- gallery-->
        {% else %}
          <div class="well">
            <div class="span8">
            {% if unlabelled %}
              Hurray! Not a single image is without a label.
            {% else %}
              There are no images uploaded yet. <a href="{{url_for('upload_file', profile=g.user.profile_name)}}">Upload them.</a>
            {% endif %}
            </div>
          </div>
        {% endif %}
      </div><!-- /span9 -->
    </div><!-- /row -->
  </section><!-- /profile -->
{% endblock %}

